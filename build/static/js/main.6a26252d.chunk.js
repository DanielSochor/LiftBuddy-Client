(window["webpackJsonpliftbuddy-client"]=window["webpackJsonpliftbuddy-client"]||[]).push([[0],{19:function(e,a,n){e.exports=n(54)},24:function(e,a,n){},25:function(e,a,n){},26:function(e,a,n){},54:function(e,a,n){"use strict";n.r(a);var t=n(0),s=n.n(t),o=n(5),l=n.n(o),i=(n(24),n(25),n(2)),r={};!function(e){var a={};e.publish=function(e,n){if(!a[e])return!1;var t=a[e],s=!0,o=!1,l=void 0;try{for(var i,r=t[Symbol.iterator]();!(s=(i=r.next()).done);s=!0){i.value.callback(n)}}catch(c){o=!0,l=c}finally{try{s||null==r.return||r.return()}finally{if(o)throw l}}},e.subscribe=function(e,n,t){a[e]||(a[e]=[]),a[e].push({observer:n,callback:t})},e.unsubscribe=function(e,n){var t=a[e];for(var s in t)if(t[s].observer===n)return t.splice(s,1),void(a[e]=t)}}(r);var c=r,u=(n(26),n(18)),m=n.n(u),g=n(3),d=n.n(g),p=function e(a){var n=typeof a;return"object"===n&&Array.isArray(a)&&(n="array"),null===a?(console.log("null type"),null):"object"===n?function(){var n={};for(var t in a)n[t]=e(a[t]);return n}():"array"===n?a.length?a.map((function(a){return e(a)})):[]:a},f={},b={};!function(e){var a="https://healthy-people-back-end.herokuapp.com/";console.log(a),e.checkForExistingSession=function(){var e=localStorage.getItem("x-session-token");e&&(console.log(a+"api/user"),d.a.get(a+"api/user",{headers:{"x-session-token":e}}).then((function(e){E(e.data)&&(b=p(e.data)),console.log(b),console.log("user is validated"),b==={}?console.log("no existing session"):console.log("existing session"),c.publish("signin",null)})).catch((function(e){console.log("session check failed"),console.log(e)}))),console.log("session token check")},e.sendSigninRequest=function(e){if(h(e)){var n={email_address:e.email_address,password:e.password};d.a.post(a+"api/users/login",n).then((function(e){var n=e.headers["x-session-token"];localStorage.setItem("x-session-token",n),d.a.get(a+"api/users",{headers:{"x-session-token":n}}).then((function(e){b=p(e.data),console.log(b),c.publish("signin",null)})).catch((function(e){console.log(e);c.publish("auth_error",{message:"Error signing in, please try again"})}))})).catch((function(e){c.publish("auth_error",{message:"Error signing in, please try again"})}))}else{c.publish("auth_error",{message:"Please fill in the required fields"})}},e.sendSignupRequest=function(e){if(v(e))console.log("sent signup request"),d.a.post(a+"api/users",{first_name:e.first_name,last_name:e.last_name,alias:e.alias,email_address:e.email,password:e.password,password_confirm:e.password_confirm}).then((function(n){var t={email_address:e.email,password:e.password};console.log(t),d.a.post(a+"api/users/login",t).then((function(e){var n=e.headers["x-session-token"];localStorage.setItem("x-session-token",n),d.a.get(a+"api/users",{headers:{"x-session-token":n}}).then((function(e){b=p(e.data),console.log(b),c.publish("signin",null)})).catch((function(e){console.log(e);c.publish("auth_error",{message:"Error signing up, please try again"})}))})).catch((function(e){console.log(e);c.publish("auth_error",{message:"Error signing up, please try again"})}))})).catch((function(e){c.publish("auth_error",{message:"Error signing up, please try again"})}));else{c.publish("auth_error",{message:"Please fill out all fields"})}},e.sendSignoutRequest=function(){var e=localStorage.getItem("x-session-token");d()({url:a+"api/users/login",method:"delete",headers:{"x-session-token":e}}).then((function(e){200===e.status?(b={},localStorage.setItem("x-session-token",""),c.publish("signout",null),console.log("signout success")):console.log("signout resolved, but not status 200")})).catch((function(e){console.log(e)}))}}(f);var h=function(e){return!(!e.alias&&!e.email_address||!e.password)},v=function(e){return console.log(e),!!(e.first_name&&e.last_name&&e.email_address&&e.alias&&e.password&&e.password_confirm)},E=function(e){return!!(e.alias&&e.created&&e.email_address&&e.first_name&&e.last_name&&e.updated&&e.user_id)},w=f,y={login:"Don't have an account?",signup:"Already have an account?"},k={login:"Log In",signup:"Sign Up"};var N=function(){var e=this,a=Object(t.useState)(k.login),n=Object(i.a)(a,2),o=n[0],l=n[1],r=Object(t.useState)(y.login),u=Object(i.a)(r,2),g=u[0],d=u[1],p=Object(t.useState)(!0),f=Object(i.a)(p,2),b=f[0],h=f[1],v=Object(t.useState)(""),E=Object(i.a)(v,2),N=E[0],_=E[1],j=Object(t.useState)(""),S=Object(i.a)(j,2),O=S[0],x=S[1],U=Object(t.useState)(""),P=Object(i.a)(U,2),C=P[0],F=P[1],q=Object(t.useState)(""),I=Object(i.a)(q,2),A=I[0],R=I[1],B=Object(t.useState)(""),L=Object(i.a)(B,2),D=L[0],J=L[1];Object(t.useEffect)((function(){return c.subscribe("login",e,M),c.subscribe("logout",e,W),c.subscribe("auth_error",e,K),w.checkForExistingSession(),function(){c.unsubscribe("login",e),c.unsubscribe("logout",e),c.unsubscribe("auth_error",e)}}),[]);var M=function(){h(!1)},W=function(){h(!0)},H=function(e){x(e.target.value)},$=function(e){F(e.target.value)},z=function(e){R(e.target.value)},G=function(e){J(e.target.value)},K=function(e){_(e.message)};return s.a.createElement(m.a,{isOpen:b,contentLabel:"Login Modal",ariaHideApp:!1},s.a.createElement("h5",{className:"modal-title"},o),s.a.createElement("div",{className:"error-info"},s.a.createElement("span",{className:"text-danger"},N)),s.a.createElement("form",null,o===k.login?s.a.createElement("div",{className:"modal-content"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"input-field col s12"},s.a.createElement("input",{id:"loginUsername",type:"text",className:"validate",value:O,onChange:H}),s.a.createElement("label",{htmlFor:"loginUsername"},"Username"))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"input-field col s12"},s.a.createElement("input",{id:"loginPassword",type:"password",className:"validate",value:A,onChange:z}),s.a.createElement("label",{htmlFor:"loginPassword"},"Password")))):o===k.signup?s.a.createElement("div",{className:"modal-content"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"input-field col s12"},s.a.createElement("input",{id:"signUpEmail",type:"email",className:"validate",value:C,onChange:$}),s.a.createElement("label",{htmlFor:"signUpEmail"},"Email"))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"input-field col s12"},s.a.createElement("input",{id:"signUpUsername",type:"text",className:"validate",value:O,onChange:H}),s.a.createElement("label",{htmlFor:"signUpUsername"},"Username"))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"input-field col s12"},s.a.createElement("input",{id:"signUpPassword",type:"password",className:"validate",value:A,onChange:z}),s.a.createElement("label",{htmlFor:"signUpPassword"},"Password"))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"input-field col s12"},s.a.createElement("input",{id:"confirmPassword",type:"password",className:"validate",value:D,onChange:G}),s.a.createElement("label",{htmlFor:"confirmPassword"},"Confirm Password")))):void console.log("error in authModal type: "+o),s.a.createElement("div",{className:"row center"},s.a.createElement("button",{type:"button",className:"btn btn-link waves-light light-blue darken-3",onClick:function(){var e=o===k.login?k.signup:k.login,a=o===k.login?y.signup:y.login;l(e),d(a)}},g)),s.a.createElement("div",{className:"modal-footer row center"},s.a.createElement("button",{className:"btn waves-effect waves-light light-blue darken-3",type:"submit",name:"action",id:"signUpBtn",href:"/homepage",onClick:function(e){if(e.preventDefault(),_(""),o===k.login){var a={username:O,password:A};console.log("sign in obj: "),console.log(a),w.sendSigninRequest(a)}else if(o===k.signup){var n={email:C,username:O,password:A,password_confirm:D};console.log("sign up obj: "),console.log(n),w.sendSignupRequest(n)}}},"Submit",s.a.createElement("i",{className:"material-icons right"},"send")))))};var _=function(){var e=this,a=Object(t.useState)(!1),n=Object(i.a)(a,2),o=(n[0],n[1]);Object(t.useEffect)((function(){return c.subscribe("login",e,r),c.subscribe("logout",e,l),function(){c.unsubscribe("login",e),c.unsubscribe("logout",e)}}),[]);var l=function(){o(!1)},r=function(){o(!0)};return s.a.createElement("div",null,s.a.createElement(N,null))};var j=function(){return s.a.createElement("div",{className:"App"},s.a.createElement(_,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(s.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[19,1,2]]]);
//# sourceMappingURL=main.6a26252d.chunk.js.map