(window["webpackJsonpliftbuddy-client"]=window["webpackJsonpliftbuddy-client"]||[]).push([[0],{19:function(e,a,n){e.exports=n(54)},24:function(e,a,n){},25:function(e,a,n){},26:function(e,a,n){},54:function(e,a,n){"use strict";n.r(a);var s=n(0),t=n.n(s),o=n(5),l=n.n(o),i=(n(24),n(25),n(2)),r={};!function(e){var a={};e.publish=function(e,n){if(!a[e])return!1;var s=a[e],t=!0,o=!1,l=void 0;try{for(var i,r=s[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){i.value.callback(n)}}catch(c){o=!0,l=c}finally{try{t||null==r.return||r.return()}finally{if(o)throw l}}},e.subscribe=function(e,n,s){a[e]||(a[e]=[]),a[e].push({observer:n,callback:s})},e.unsubscribe=function(e,n){var s=a[e];for(var t in s)if(s[t].observer===n)return s.splice(t,1),void(a[e]=s)}}(r);var c=r,u=(n(26),n(18)),m=n.n(u),g=n(3),d=n.n(g),p=function e(a){var n=typeof a;return"object"===n&&Array.isArray(a)&&(n="array"),null===a?(console.log("null type"),null):"object"===n?function(){var n={};for(var s in a)n[s]=e(a[s]);return n}():"array"===n?a.length?a.map((function(a){return e(a)})):[]:a},f={},v={};!function(e){var a="https://lift-buddy-server.herokuapp.com/";console.log("baseURL is: "+a),console.log("local storage"),console.log(localStorage),e.checkForExistingSession=function(){var e=localStorage.getItem("x-session-token");e?(console.log("session token exists"),console.log("session token is: "+e),d.a.get(a+"api/users",{headers:{"x-session-token":e}}).then((function(e){E(e.data)&&(v=p(e.data),console.log("deep copy of user is: "),console.log(v),console.log("user is validated")),v==={}?console.log("no existing session"):console.log("existing session"),c.publish("login",null)})).catch((function(e){console.log("session check failed"),console.log(e)}))):console.log("no session token exists")},e.sendSigninRequest=function(e){if(b(e)){var n={username:e.username,password:e.password};console.log("pre sign in"),console.log(n),console.log(a+"api/users/login"),d.a.post(a+"api/users/login",n).then((function(e){var n=e.headers["x-session-token"];localStorage.setItem("x-session-token",n),d.a.get(a+"api/users",{headers:{"x-session-token":n}}).then((function(e){v=p(e.data),console.log("attempt at /api/user"),console.log(v),c.publish("login",null)})).catch((function(e){console.log(e);c.publish("auth_error",{message:"Error signing in, please try again"})}))})).catch((function(e){c.publish("auth_error",{message:"Error signing in, please try again"})}))}else{c.publish("auth_error",{message:"Please fill in the required fields"})}},e.sendSignupRequest=function(e){if(h(e))console.log("sent signup request"),d.a.post(a+"api/users",{first_name:e.first_name,last_name:e.last_name,username:e.username,email_address:e.email_address,password:e.password,password_confirm:e.password_confirm}).then((function(n){var s={username:e.username,email_address:e.email_address,password:e.password};console.log("signin object is: "),console.log(s),d.a.post(a+"api/users/login",s).then((function(e){console.log("sign in response"),console.log(e.headers);var n=e.headers["x-session-token"];console.log("session token is"),console.log(n),localStorage.setItem("x-session-token",n),d.a.get(a+"api/users",{headers:{"x-session-token":n}}).then((function(e){v=p(e.data),console.log("post to login:"),console.log(v),c.publish("login",null)})).catch((function(e){console.log(e);c.publish("auth_error",{message:"Error signing up, please try again"})}))})).catch((function(e){console.log(e);c.publish("auth_error",{message:"Error signing up, please try again"})}))})).catch((function(e){c.publish("auth_error",{message:"Error signing up, please try again"})}));else{c.publish("auth_error",{message:"Please fill out all fields"})}},e.sendSignoutRequest=function(){var e=localStorage.getItem("x-session-token");d()({url:a+"api/users/login",method:"delete",headers:{"x-session-token":e}}).then((function(e){200===e.status?(v={},localStorage.setItem("x-session-token",""),c.publish("logout",null),console.log("signout success")):console.log("signout resolved, but not status 200")})).catch((function(e){console.log(e)}))}}(f);var b=function(e){return(e.username||e.email_address)&&e.password?(console.log("user is validated"),!0):(console.log("user is not validated"),!1)},h=function(e){return e.first_name&&e.last_name&&e.username&&e.email_address&&e.password&&e.password_confirm?(console.log("signup has the correct parameters"),!0):(console.log("signup does not have the correct parameters"),!1)},E=function(e){return e.user_id&&e.first_name&&e.last_name&&e.username&&e.email_address&&e.created&&e.updated?(console.log("user data validates as true"),!0):(console.log("user data validates as false"),!1)},w=f,N={login:"Don't have an account?",signup:"Already have an account?"},y={login:"Log In",signup:"Sign Up"};var _=function(){var e=this,a=Object(s.useState)(y.login),n=Object(i.a)(a,2),o=n[0],l=n[1],r=Object(s.useState)(N.login),u=Object(i.a)(r,2),g=u[0],d=u[1],p=Object(s.useState)(!0),f=Object(i.a)(p,2),v=f[0],b=f[1],h=Object(s.useState)(""),E=Object(i.a)(h,2),_=E[0],k=E[1],j=Object(s.useState)(""),S=Object(i.a)(j,2),O=S[0],x=S[1],U=Object(s.useState)(""),F=Object(i.a)(U,2),C=F[0],P=F[1],q=Object(s.useState)(""),I=Object(i.a)(q,2),L=I[0],R=I[1],A=Object(s.useState)(""),B=Object(i.a)(A,2),D=B[0],J=B[1],M=Object(s.useState)(""),W=Object(i.a)(M,2),H=W[0],$=W[1],z=Object(s.useState)(""),G=Object(i.a)(z,2),K=G[0],Q=G[1];Object(s.useEffect)((function(){return c.subscribe("login",e,T),c.subscribe("logout",e,V),c.subscribe("auth_error",e,se),w.checkForExistingSession(),function(){c.unsubscribe("login",e),c.unsubscribe("logout",e),c.unsubscribe("auth_error",e)}}),[]);var T=function(){b(!1)},V=function(){b(!0)},X=function(e){x(e.target.value)},Y=function(e){P(e.target.value)},Z=function(e){R(e.target.value)},ee=function(e){J(e.target.value)},ae=function(e){$(e.target.value)},ne=function(e){Q(e.target.value)},se=function(e){k(e.message)};return t.a.createElement(m.a,{isOpen:v,contentLabel:"Login Modal",ariaHideApp:!1},t.a.createElement("h5",{className:"modal-title"},o),t.a.createElement("div",{className:"error-info"},t.a.createElement("span",{className:"text-danger"},_)),t.a.createElement("form",null,o===y.login?t.a.createElement("div",{className:"modal-content"},t.a.createElement("div",{className:"row"},t.a.createElement("div",{className:"input-field col s12"},t.a.createElement("input",{id:"loginUsername",type:"text",className:"validate",value:L,onChange:Z}),t.a.createElement("label",{htmlFor:"loginUsername"},"Username"))),t.a.createElement("div",{className:"row"},t.a.createElement("div",{className:"input-field col s12"},t.a.createElement("input",{id:"loginPassword",type:"password",className:"validate",value:H,onChange:ae}),t.a.createElement("label",{htmlFor:"loginPassword"},"Password")))):o===y.signup?t.a.createElement("div",{className:"modal-content"},t.a.createElement("div",{className:"row"},t.a.createElement("div",{className:"input-field col s12"},t.a.createElement("input",{id:"signUpFirstName",type:"text",className:"validate",value:O,onChange:X}),t.a.createElement("label",{htmlFor:"signUpFirstName"},"First Name"))),t.a.createElement("div",{className:"row"},t.a.createElement("div",{className:"input-field col s12"},t.a.createElement("input",{id:"signUpLastName",type:"text",className:"validate",value:C,onChange:Y}),t.a.createElement("label",{htmlFor:"signUpLastName"},"Last Name"))),t.a.createElement("div",{className:"row"},t.a.createElement("div",{className:"input-field col s12"},t.a.createElement("input",{id:"signUpUsername",type:"text",className:"validate",value:L,onChange:Z}),t.a.createElement("label",{htmlFor:"signUpUsername"},"Username"))),t.a.createElement("div",{className:"row"},t.a.createElement("div",{className:"input-field col s12"},t.a.createElement("input",{id:"signUpEmail",type:"email",className:"validate",value:D,onChange:ee}),t.a.createElement("label",{htmlFor:"signUpEmail"},"Email"))),t.a.createElement("div",{className:"row"},t.a.createElement("div",{className:"input-field col s12"},t.a.createElement("input",{id:"signUpPassword",type:"password",className:"validate",value:H,onChange:ae}),t.a.createElement("label",{htmlFor:"signUpPassword"},"Password"))),t.a.createElement("div",{className:"row"},t.a.createElement("div",{className:"input-field col s12"},t.a.createElement("input",{id:"confirmPassword",type:"password",className:"validate",value:K,onChange:ne}),t.a.createElement("label",{htmlFor:"confirmPassword"},"Confirm Password")))):void console.log("error in authModal type: "+o),t.a.createElement("div",{className:"row center"},t.a.createElement("button",{type:"button",className:"btn btn-link waves-light light-blue darken-3",onClick:function(){var e=o===y.login?y.signup:y.login,a=o===y.login?N.signup:N.login;l(e),d(a)}},g)),t.a.createElement("div",{className:"modal-footer row center"},t.a.createElement("button",{className:"btn waves-effect waves-light light-blue darken-3",type:"submit",name:"action",id:"signUpBtn",href:"/homepage",onClick:function(e){if(e.preventDefault(),k(""),o===y.login){var a={username:L,password:H};console.log("sign in obj: "),console.log(a),w.sendSigninRequest(a)}else if(o===y.signup){var n={first_name:O,last_name:C,email_address:D,username:L,password:H,password_confirm:K};console.log("sign up obj: "),console.log(n),w.sendSignupRequest(n)}}},"Submit",t.a.createElement("i",{className:"material-icons right"},"send")))))};var k=function(){var e=this,a=Object(s.useState)(!1),n=Object(i.a)(a,2),o=(n[0],n[1]);Object(s.useEffect)((function(){return c.subscribe("login",e,r),c.subscribe("logout",e,l),function(){c.unsubscribe("login",e),c.unsubscribe("logout",e)}}),[]);var l=function(){o(!1)},r=function(){o(!0)};return t.a.createElement("div",null,t.a.createElement(_,null))};var j=function(){return t.a.createElement("div",{className:"App"},t.a.createElement(k,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(t.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[19,1,2]]]);
//# sourceMappingURL=main.cc97ff9c.chunk.js.map